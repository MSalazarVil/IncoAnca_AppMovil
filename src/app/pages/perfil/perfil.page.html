<ion-header>
  <ion-toolbar class="toolbar-perfil">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Mi Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="perfil-card">
    <div class="perfil-top">
      <div class="avatar">
        <ion-icon name="person-circle-outline"></ion-icon>
      </div>
      <div class="datos">
        <div class="nombre">{{ user?.nombre || nombre }}</div>
        <div class="rol-pill">{{ (user?.rol || rol) | titlecase }}</div>
      </div>
    </div>

    <div class="perfil-info">
      <div class="info-row">
        <ion-icon name="person-outline"></ion-icon>
        <div class="label">Nombre</div>
        <div class="value">{{ user?.nombre || nombre }}</div>
      </div>
      <div class="info-row">
        <ion-icon name="id-card-outline"></ion-icon>
        <div class="label">Rol</div>
        <div class="value">{{ (user?.rol || rol) | titlecase }}</div>
      </div>
      <div class="info-row" *ngIf="user?.username">
        <ion-icon name="at-outline"></ion-icon>
        <div class="label">Usuario</div>
        <div class="value">{{ user?.username }}</div>
      </div>
      <div class="info-row" *ngIf="user?.email">
        <ion-icon name="mail-outline"></ion-icon>
        <div class="label">Email</div>
        <div class="value">{{ user?.email }}</div>
      </div>
      <div class="info-row" *ngIf="user?.createdAt">
        <ion-icon name="time-outline"></ion-icon>
        <div class="label">Creado</div>
        <div class="value">{{ user?.createdAt }}</div>
      </div>
  </div>

  <div class="perfil-actions">
      <ion-button fill="outline">
        <ion-icon name="pencil-outline" slot="start"></ion-icon>
        Editar perfil
      </ion-button>
      <ion-button fill="outline">
        <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
        Cambiar contraseña
      </ion-button>
  </div>

  <ion-button expand="block" color="danger" (click)="cerrarSesion()" class="btn-salir">
      Cerrar sesión
  </ion-button>
  
  <!-- empresa asociada a cliente -->
  <div *ngIf="(user?.rol || rol) === 'cliente' && empresa" class="empresa-card">
    <div class="empresa-title">Empresa</div>
    <div class="empresa-row"><span class="label">Razón social</span><span class="value">{{ empresa.razonSocial }}</span></div>
    <div class="empresa-row"><span class="label">RUC</span><span class="value">{{ empresa.ruc }}</span></div>
    <div class="empresa-row"><span class="label">Dirección</span><span class="value">{{ empresa['direccion'] }}</span></div>
    <div class="empresa-row"><span class="label">Teléfono</span><span class="value">{{ empresa.telefono }}</span></div>
    <div class="empresa-row"><span class="label">Tipo</span><span class="value">{{ empresa.tipoEntidad }}</span></div>
    <div class="empresa-row"><span class="label">Estado</span><span class="value">{{ empresa.estado | titlecase }}</span></div>
    <div class="empresa-row"><span class="label">Registro</span><span class="value">{{ empresa.fechaRegistro }}</span></div>
  </div>
  <div *ngIf="(user?.rol || rol) === 'cliente' && !empresa" class="empresa-empty">Sin empresa asociada</div>
</div>
</ion-content>
