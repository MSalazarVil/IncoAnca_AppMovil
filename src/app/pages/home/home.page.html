<ion-header class="ion-no-border">
  <ion-toolbar class="toolbar-home">
    <ion-buttons slot="start">
      <img src="assets/img/logo.png" alt="Logo" class="toolbar-logo" />
    </ion-buttons>
    <ion-title class="ion-text-center">
      {{ nombreUsuario }}
    </ion-title>
    <ion-buttons slot="end">
      <ion-button
        (click)="navigateAndBlur('/profile')"
        aria-label="Perfil de usuario"
      >
        <ion-icon src="assets/icons/user-circle.svg"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="ion-padding">
    <ion-searchbar
      class="custom-searchbar"
      placeholder="Buscar un proyecto"
      aria-label="Buscar proyectos"
      [(ngModel)]="searchTerm"
      (ionInput)="filterProyectos()"
    ></ion-searchbar>

    <div class="accesos-rapidos">
      <ion-button
        class="tile"
        expand="block"
        fill="clear"
        (click)="navigateAndBlur('/documentos')"
        aria-label="Ver documentos"
      >
        <ion-icon src="assets/icons/file-description.svg"></ion-icon>
        <span>Documentos</span>
      </ion-button>
      <ion-button
        class="tile"
        expand="block"
        fill="clear"
        (click)="navigateAndBlur('/observaciones')"
        aria-label="Ver observaciones"
      >
        <ion-icon src="assets/icons/message.svg"></ion-icon>
        <span>Observaciones</span>
      </ion-button>
      <ion-button
        class="tile"
        expand="block"
        fill="clear"
        (click)="navigateAndBlur('/reportes')"
        aria-label="Ver reportes"
      >
        <ion-icon src="assets/icons/chart-bar-popular.svg"></ion-icon>
        <span>Reportes</span>
      </ion-button>
      <ion-button
        *ngIf="isEmpleado"
        class="tile"
        expand="block"
        fill="clear"
        (click)="navigateAndBlur('/clientes')"
        aria-label="Ver clientes"
      >
        <ion-icon src="assets/icons/users.svg"></ion-icon>
        <span>Clientes</span>
      </ion-button>
    </div>

    <ion-button
      *ngIf="isEmpleado"
      class="btn-nuevo-proyecto"
      expand="block"
      (click)="navigateAndBlur('/nuevo-proyecto')"
      aria-label="Agregar nuevo proyecto"
    >
      <ion-icon slot="start" src="assets/icons/plus.svg"></ion-icon>
      Agregar Nuevo Proyecto
    </ion-button>

    <h2 class="lista-titulo">
      Lista de proyectos {{ segmentoSeleccionado === 'activos' ? 'activos' :
      'terminados' }}
    </h2>

    <ion-segment
      [(ngModel)]="segmentoSeleccionado"
      class="seg-proyectos"
      mode="md"
    >
      <ion-segment-button value="activos">
        <ion-label>Proyectos Activos</ion-label>
      </ion-segment-button>
      <ion-segment-button value="terminados">
        <ion-label>Proyectos Terminados</ion-label>
      </ion-segment-button>
    </ion-segment>

    <div class="lista-proyectos">
      <!-- Proyectos Activos -->
      <ng-container *ngIf="segmentoSeleccionado === 'activos'">
        <ion-card
          class="card-proyecto-activo"
          *ngFor="let proyecto of proyectosActivos"
        >
          <div class="card-header">
            <h3 class="titulo-activo">{{ proyecto.nombre }}</h3>
            <span class="estado-activo">{{ proyecto.estado }}</span>
          </div>

          <div class="acciones">
            <span class="obs"
              >Observaciones: {{ proyecto.numObservaciones }}</span
            >
            <ion-button
              class="btn-ver-link"
              fill="clear"
              size="small"
              (click)="navigateAndBlur(['/detalle-proyecto', proyecto.id])"
            >
              Ver
            </ion-button>
          </div>
        </ion-card>
      </ng-container>

      <!-- Proyectos Terminados -->
      <ng-container *ngIf="segmentoSeleccionado === 'terminados'">
        <ion-card
          class="card-proyecto-terminado"
          *ngFor="let proyecto of proyectosTerminados"
        >
          <div class="card-main">
            <h3 class="titulo-terminado">{{ proyecto.nombre }}</h3>
            <span class="estado estado-fin">{{ proyecto.estado }}</span>
          </div>
          <ion-button
            class="btn-ver"
            fill="clear"
            size="small"
            (click)="navigateAndBlur(['/detalle-proyecto', proyecto.id])"
          >
            Ver
          </ion-button>
        </ion-card>
      </ng-container>
    </div>
  </div>
</ion-content>
